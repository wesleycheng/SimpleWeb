"use strict";!function(e){var t=function(e){this.pickerOpts=e,this.prefix="_picker-"+(new Date).getTime(),this.itemHeight=30,this.pos={startY:0,moveY:0,endY:0,currY:0,itemStartY:0,top:0,bottom:0},this.createPickerDom(this.pickerOpts),this._pMaks=document.querySelector("."+this.prefix),this.cols=document.querySelectorAll("."+this.prefix+" ._picker-col"),this.col_list=document.querySelectorAll("."+this.prefix+" ._picker-data-list"),this.btnCancel=document.querySelector("."+this.prefix+" ._picker-btn-cancel"),this.btnConfirm=document.querySelector("."+this.prefix+" ._picker-btn-confirm"),this.selector=document.getElementById(this.pickerOpts.selector),this.bind()};t.prototype={bind:function(){var e=this;this.btnCancel.addEventListener("touchend",function(){"function"==typeof e.pickerOpts.onCancel&&e.pickerOpts.onCancel(),e._pMaks.className="_picker-mask hide"},!1),this.btnConfirm.addEventListener("touchend",function(){if("function"==typeof e.pickerOpts.onConfirm){for(var t=[],c=0;c<e.pickerOpts.cols.length;c++)e.pickerOpts.cols[c].currVal?t.push(e.pickerOpts.cols[c].currVal):t.push(e.pickerOpts.cols[c].values[0]);e.pickerOpts.onConfirm(t)}e._pMaks.className="_picker-mask hide"},!1),this.selector.addEventListener("touchend",function(){e._pMaks.className="_picker-mask "+e.prefix},!1);for(var t=0;t<this.cols.length;t++)this.cols[t].addEventListener("touchstart",e.touchEventCallBack(t,"touchstart",e.pos),!1),this.cols[t].addEventListener("touchmove",e.touchEventCallBack(t,"touchmove",e.pos),!1),this.cols[t].addEventListener("touchend",e.touchEventCallBack(t,"touchend",e.pos),!1)},touchEventCallBack:function(e,t,c){var r=this;return function(i){switch(i.preventDefault(),t){case"touchstart":c.startY=i.touches[0].clientY,c.currY=c.itemStartY=(3-r.pickerOpts.cols[e].currIndex)*r.itemHeight,c.top=3*r.itemHeight,c.bottom=(3-(r.pickerOpts.cols[e].values.length-1))*r.itemHeight;break;case"touchmove":c.moveY=i.changedTouches[0].clientY,c.currY=c.itemStartY+(c.moveY-c.startY),r.col_list[e].setAttribute("style","-webkit-transform:translateY("+c.currY+"px);transform:translateY("+c.currY+"px)");break;case"touchend":c.endY=i.changedTouches[0].clientY;var s=Math.round((c.startY-c.endY)/r.itemHeight)+r.pickerOpts.cols[e].currIndex,n=r.pickerOpts.cols[e].values.length;s<0?s=0:s>=n&&(s=n-1),r.pickerOpts.cols[e].currIndex=s,r.pickerOpts.cols[e].currVal=r.pickerOpts.cols[e].values[s],r.col_list[e].setAttribute("style","-webkit-transform:translateY("+(3-s)*r.itemHeight+"px);transform:translateY("+(3-s)*r.itemHeight+"px);"),"function"==typeof r.pickerOpts.onOptionSelected&&r.pickerOpts.onOptionSelected(e,r.pickerOpts.cols[e].currIndex,r.pickerOpts.cols[e].currVal)}}},createPickerDom:function(e){for(var t="",c=0;c<e.cols.length;c++){if(e.cols[c].currVal){var r=e.cols[c].values.indexOf(e.cols[c].currVal);r===-1?(e.cols[c].currIndex=0,e.cols[c].currVal=e.cols[c].values[0]):e.cols[c].currIndex=r}else e.cols[c].currIndex=0,e.cols[c].currVal=e.cols[c].values[0];t+='<div class="_picker-col">',t+=this.setOptions(e.cols[c]),t+="</div>"}var i='<div class="_picker-mask hide '+this.prefix+'"><div class="_picker-wrapper"><div class="_picker-head"><h3 class="_picker-title">'+e.title+'</h3><a class="_picker-btn-cancel" href="javascript:;">取消</a><a class="_picker-btn-confirm" href="javascript:;">确定</a></div><div class="_picker-content">'+t+"</div></div></div>",s=document.createElement("div");s.innerHTML=i,document.body.appendChild(s)},setOptions:function(e){if(e.currVal){var t=e.values.indexOf(e.currVal);t===-1?(e.currVal=e.values[0],e.currIndex=0):e.currIndex=t}else e.currVal=e.values[0],e.currIndex=0;for(var c='<ul class="_picker-data-list" style="-webkit-transform:translateY('+(3-e.currIndex)*this.itemHeight+"px);transform:translateY("+(3-e.currIndex)*this.itemHeight+'px)">',r=0;r<e.values.length;r++)c+="<li>"+e.values[r]+"</li>";return c+"</ul>"},updateCol:function(e,t){this.cols[e].innerHTML=this.setOptions(t),this.pickerOpts.cols[e]=t,this.col_list=document.querySelectorAll("."+this.prefix+" ._picker-data-list")}},e.PickerView=t}(window),"function"==typeof define&&define.amd&&define("pickerView",[],function(){return PickerView});